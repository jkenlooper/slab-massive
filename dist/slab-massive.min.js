(function () {
'use strict';

var _Mathround=Math.round;
var _Mathmin=Math.min;const duration=300;class ScrollAnimation{constructor(a,b,c){this.start=null,this.element=a,this.startX=a.scrollLeft,this.startY=a.scrollTop,this.distX=b-this.startX,this.distY=c-this.startY,this.animateID=window.requestAnimationFrame(this.step.bind(this));}step(a){this.start||(this.start=a);let b=a-this.start,c=_Mathround(this.startX+_Mathmin(b/duration,1)*this.distX),d=_Mathround(this.startY+_Mathmin(b/duration,1)*this.distY);this.element.scrollLeft=c,this.element.scrollTop=d,b<duration&&(this.animateID=window.requestAnimationFrame(this.step.bind(this)));}stop(){window.cancelAnimationFrame(this.animateID);}}

function fullscreen(a,b){function c(){document.mozFullScreenElement||document.fullscreenElement||document.webkitFullscreenElement?document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);}return a.addEventListener('click',function(){c();},!1),{}}

function debounce(a,b,c){let d;return function(){const e=this,f=arguments,h=c&&!d;window.clearTimeout(d),d=window.setTimeout(function(){d=null,c||a.apply(e,f);},b),h&&a.apply(e,f);}}

var style = ":host{display:block;contain:content}*{box-sizing:border-box}.sm-Slab{position:relative;overflow:hidden}.sm-Slab>*{position:absolute;z-index:2}.sm-Slab-container{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;z-index:1;overflow:scroll}.sm-Slab-slotWrapper{overflow:hidden}.sm-Slab-slot{-webkit-transform-origin:0 0;transform-origin:0 0;outline:1px solid red}.sm-Slab-slot.is-animating{transition:-webkit-transform .5s linear;transition:transform .5s linear;transition:transform .5s linear,-webkit-transform .5s linear}.sm-Slab-zoomControls{display:-webkit-box;display:-ms-flexbox;display:flex;top:0;left:0;border-bottom:4px ridge hsla(0,0%,100%,.5);height:34px}.sm-Slab.is-minimized .sm-Slab-zoomControls{visibility:hidden}.sm-Slab-zoomControls>*+*{margin-left:5px}.sm-Slab-button{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:block;cursor:pointer;margin-top:5px;outline:0;border-top:1px solid hsla(0,0%,100%,.6);border-right:1px solid hsla(0,0%,100%,.6);border-bottom:0;border-left:1px solid hsla(0,0%,100%,.6);border-radius:35% 35% 0 0;background:rgba(0,0,0,.2);padding:0 .4em .2em;height:25px;color:hsla(0,0%,100%,.6);font-size:20px;font-weight:900;line-height:1.2em}.sm-Slab-button:disabled{opacity:.5;cursor:default}.sm-Slab-button--toggle{margin-top:0;margin-bottom:5px;border-top:0;border-bottom:1px solid hsla(0,0%,100%,.6);border-radius:0 0 35% 35%}.sm-Slab.is-minimized .sm-Slab-button--toggle{visibility:visible;opacity:.5}.sm-Slab-buttonText{display:inline-block;transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.sm-Slab-button--toggle .sm-Slab-buttonText{-webkit-transform:scaleY(-1);transform:scaleY(-1)}.sm-Slab.is-minimized .sm-Slab-button--toggle .sm-Slab-buttonText{-webkit-transform:scaleY(1);transform:scaleY(1)}.sm-ViewFinder{top:30px;left:0;cursor:crosshair}.sm-Slab.is-minimized .sm-ViewFinder{display:none}.sm-ViewFinder:after,.sm-ViewFinder:before{position:absolute;opacity:.5;width:20%;height:20%;content:\"\"}.sm-ViewFinder:before{top:0;left:0;border-left:4px ridge #fff}.sm-ViewFinder:after{right:0;bottom:0;border-right:4px ridge #fff;border-bottom:4px ridge #fff}.sm-ViewFinder-box{-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-transform-origin:0 0;transform-origin:0 0;opacity:.5;transition:-webkit-transform .3s linear;transition:transform .3s linear;transition:transform .3s linear,-webkit-transform .3s linear;cursor:crosshair;border:1px dashed #000;background-color:hsla(0,0%,100%,.4);width:30px;height:30px}";

var template = "<div id=sm-slab class=sm-Slab> <div id=sm-viewfinder class=sm-ViewFinder> <slot id=view-finder name=view-finder> </slot> <div id=sm-viewfinderbox class=sm-ViewFinder-box></div> </div> <div class=sm-Slab-container unselectable=on onselectstart=return!1 onmousedown=return!1> <div class=sm-Slab-slotWrapper> <div class=sm-Slab-slot> <slot> </slot> </div> </div> </div> <div class=sm-Slab-zoomControls> <button id=sm-zoomin-button class=sm-Slab-button> <span class=sm-Slab-buttonText> + </span> </button> <button id=sm-zoomout-button class=sm-Slab-button> <span class=sm-Slab-buttonText> - </span> </button> <button id=sm-fullscreen-button class=sm-Slab-button> <span class=sm-Slab-buttonText> &harr; </span> </button> <button id=sm-toggle-button class=\"sm-Slab-button sm-Slab-button--toggle\"> <span class=sm-Slab-buttonText> &#9650; </span> </button> </div> </div> ";

var version = "0.2.0";
var description = "Web Component for displaying and navigating partial content";
var repository = { "type": "git", "url": "https://github.com/jkenlooper/slab-massive" };




var author = "Jake Hickenlooper";

var _Mathfloor=Math.floor;
var _Mathmax=Math.max;const html=`
<!--
Slab Massive ${version}
${description}
${author}
${repository.url}
-->
<style>${style}</style>
${template}
`; const viewFinderMax=150; const maximumScale=1;window.customElements.define('slab-massive',class extends HTMLElement{constructor(){super();const a=this.attachShadow({mode:'open'});a.innerHTML=html,this.flags={isMinimized:!1},this.slab=a.getElementById('sm-slab'),this.container=a.querySelector('.sm-Slab-container'),this._slot=a.querySelector('.sm-Slab-slot'),this.slotWrapper=a.querySelector('.sm-Slab-slotWrapper'),this.viewFinder=a.getElementById('sm-viewfinder'),this.viewFinderBox=a.getElementById('sm-viewfinderbox'),this.viewFinder.x=this.viewFinder.offsetLeft+this.offsetLeft,this.viewFinder.y=this.viewFinder.offsetTop+this.offsetTop,this.zoomInEl=a.getElementById('sm-zoomin-button');let b=this.zoomIn.bind(this);this.zoomInEl.addEventListener('click',b),this.zoomOutEl=a.getElementById('sm-zoomout-button');let c=this.zoomOut.bind(this);this.zoomOutEl.addEventListener('click',c),this.toggleEl=a.getElementById('sm-toggle-button'),this.toggleEl.addEventListener('click',this.toggle.bind(this)),this.render();let d=this.handleScroll.bind(this);this.container.addEventListener('scroll',d),this.viewFinder.addEventListener('mousedown',this.handleViewFinderMousedown.bind(this)),this.fullscreenButton=a.getElementById('sm-fullscreen-button');let e=this.parentElement;fullscreen(this.fullscreenButton,e,this),window.addEventListener('deviceorientation',this.handleWindowResize.bind(this));let f=debounce(this.handleWindowResize,100,!1).bind(this);window.addEventListener('resize',f);}connectedCallback(){}static get observedAttributes(){return['zoom','offset-x','offset-y','width','height','fill']}attributeChangedCallback(a,b,c){b!==c&&(this[a]=c,'zoom'===a?(this.renderZoom(),this.renderSlotPosition()):'offset-x'===a?this.renderSlotPosition():'offset-y'===a?this.renderSlotPosition():'width'===a?this.render():'height'===a?this.render():'fill'===a?this.render():void 0);}render(){const a=+(this.zoom===void 0?this.getAttribute('zoom'):this.zoom);let b=this.parentNode.offsetWidth,c=this.parentNode.offsetHeight;const d=b>c,e=this.width>this.height;'contain'===this.fill?b/this.width*this.height>c?this.scale=c/this.height:this.scale=b/this.width:d&&e||!d&&!e?this.scale=_Mathmax(c,b)/_Mathmax(this.height,this.width):d&&!e?this.scale=_Mathmax(c,b)/this.width:!d&&e&&(this.scale=_Mathmax(c,b)/this.height),0===a&&(this.zoom=maximumScale/this.scale,this.attributeChangedCallback('zoom','0',this.zoom)),this.style.width=this.slab.style.width=this.container.style.width=b+'px',this.style.height=this.slab.style.height=this.container.style.height=c+'px',d&&e||!d&&!e?this.viewFinder.scale=viewFinderMax/_Mathmax(this.height,this.width):d&&!e?this.viewFinder.scale=viewFinderMax/this.width:!d&&e&&(this.viewFinder.scale=viewFinderMax/this.height);let f=0,g=0,h=this.width*this.viewFinder.scale,i=this.height*this.viewFinder.scale;d&&e?(f=viewFinderMax,g=c/b*viewFinderMax):d||e?d?(f=viewFinderMax,g=c/b*viewFinderMax):e&&(f=b/c*viewFinderMax,g=viewFinderMax):(f=b/c*viewFinderMax,g=viewFinderMax),this.viewFinder.style.width=_Mathfloor(h)+'px',this.viewFinder.style.height=_Mathfloor(i)+'px',this.viewFinderBox.style.width=_Mathfloor(f)+'px',this.viewFinderBox.style.height=_Mathfloor(g)+'px',this._slot.style.width=this.width+'px',this._slot.style.height=this.height+'px',this.renderZoom(),this.renderSlotPosition();}renderZoom(){maximumScale/this.scale===this.zoom?this.zoomInEl.setAttribute('disabled',!0):this.zoomInEl.hasAttribute('disabled')&&this.zoomInEl.removeAttribute('disabled'),1>=this.zoom?this.zoomOutEl.setAttribute('disabled',!0):this.zoomOutEl.hasAttribute('disabled')&&this.zoomOutEl.removeAttribute('disabled');}renderSlotPosition(){this.slotWrapper.style.width=this.width*this.scale*this.zoom+'px',this.slotWrapper.style.height=this.height*this.scale*this.zoom+'px',this._slot.style.transform=`scale(${this.scale*this.zoom})`,this.viewFinderBox.style.transform=`translate3d(${_Mathfloor(this.offsetX*this.viewFinder.scale/this.scale/this.zoom)}px, ${_Mathfloor(this.offsetY*this.viewFinder.scale/this.scale/this.zoom)}px, 0) scale(${1/this.zoom})`,this.viewFinderBox.style.borderWidth=this.zoom+'px';}moveBy(a,b){this.pageToOffset(this.viewFinder.startX+a,this.viewFinder.startY+b);}scrollTo(a,b,c){this.scrollAnimation&&(this.scrollAnimation.stop(),this.scrollAnimation=null),c?(this._slot.classList.add('is-animating'),this.scrollAnimation=new ScrollAnimation(this.container,a,b)):(this._slot.classList.remove('is-animating'),this.container.scrollLeft=a,this.container.scrollTop=b);}pageToOffset(a,b,c){const d=document.mozFullScreenElement||document.fullscreenElement||document.webkitFullscreenElement,e=d?0:this.offsetTop,f=d?0:this.offsetLeft;this.scrollAnimation&&(this.scrollAnimation.stop(),this.scrollAnimation=null),this.viewFinder.x=a,this.viewFinder.y=b;let g=a-(this.viewFinder.offsetLeft+f),h=b-(this.viewFinder.offsetTop+e),i=g/this.viewFinder.scale*this.scale*this.zoom,j=h/this.viewFinder.scale*this.scale*this.zoom;c?(this._slot.classList.add('is-animating'),this.scrollAnimation=new ScrollAnimation(this.container,i,j)):(this._slot.classList.remove('is-animating'),this.container.scrollLeft=i,this.container.scrollTop=j);}handleScroll(){let b=this.container.scrollLeft*this.viewFinder.scale,c=this.container.scrollTop*this.viewFinder.scale;this.offsetX=b/this.viewFinder.scale,this.offsetY=c/this.viewFinder.scale;}handleWindowResize(){const b=document.mozFullScreenElement||document.fullscreenElement||document.webkitFullscreenElement;this.fill=b?'cover':this.getAttribute('fill'),this.render();}handleViewFinderMousedown(a){this.viewFinderClick({type:'tap',pageX:a.pageX,pageY:a.pageY});}viewFinderClick(a){const b=a.pageX-this.viewFinderBox.offsetWidth/this.zoom/2,c=a.pageY-this.viewFinderBox.offsetHeight/this.zoom/2;switch(a.type){case'tap':this.pageToOffset(b,c,!0);break;case'panstart':this.viewFinderBox.classList.add('is-dragging'),this.viewFinder.x=this.viewFinder.startX=b,this.viewFinder.y=this.viewFinder.startY=c;break;case'panmove':this.moveBy(a.deltaX,a.deltaY);break;case'panend':this.viewFinderBox.classList.remove('is-dragging'),this.moveBy(a.deltaX,a.deltaY);}}zoomIn(){const a=2*+this.offsetX+2*(this.offsetWidth/4),b=2*+this.offsetY+2*(this.offsetHeight/4),c=Math.min(maximumScale/this.scale,2*this.zoom);this.setAttribute('zoom',c),this.zoom=c,this.scrollTo(a,b,!1);}zoomOut(){const a=_Mathmax(+this.offsetX/2-this.offsetWidth/4,0),b=_Mathmax(+this.offsetY/2-this.offsetHeight/4,0),c=_Mathmax(this.zoom/2,1);this.setAttribute('zoom',c),this.zoom=c,this.scrollTo(a,b,!1);}toggle(){this.flags.isMinimized=!this.flags.isMinimized,this.slab.classList.toggle('is-minimized',this.flags.isMinimized);}get offsetX(){return this.getAttribute('offset-x')}set offsetX(a){this.setAttribute('offset-x',a);}get offsetY(){return this.getAttribute('offset-y')}set offsetY(a){this.setAttribute('offset-y',a);}get width(){return this.getAttribute('width')}set width(a){a!==this.width&&this.setAttribute('width',a);}get height(){return this.getAttribute('height')}set height(a){a!==this.height&&this.setAttribute('height',a);}get fill(){return this.getAttribute('fill')}set fill(a){a!==this.fill&&this.setAttribute('fill',a);}});

}());
